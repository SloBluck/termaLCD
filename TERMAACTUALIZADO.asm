
; PICBASIC PRO(TM) Compiler 2.60, (c) 1998, 2009 microEngineering Labs, Inc. All Rights Reserved. 
_USED			EQU	1

	INCLUDE	"C:\PBP\16F877A.INC"


; Define statements.
#define		CODE_SIZE		 8
#define		OSC		 4
#define		LCD_DREG		 PORTC
#define		LCD_DBIT		 4
#define		LCD_RSREG		 PORTC
#define		LCD_RSBIT		 0
#define		LCD_EREG		 PORTC
#define		LCD_EBIT		 1

RAM_START       		EQU	00020h
RAM_END         		EQU	001EFh
RAM_BANKS       		EQU	00004h
BANK0_START     		EQU	00020h
BANK0_END       		EQU	0007Fh
BANK1_START     		EQU	000A0h
BANK1_END       		EQU	000EFh
BANK2_START     		EQU	00110h
BANK2_END       		EQU	0016Fh
BANK3_START     		EQU	00190h
BANK3_END       		EQU	001EFh
EEPROM_START    		EQU	02100h
EEPROM_END      		EQU	021FFh

R0              		EQU	RAM_START + 000h
R1              		EQU	RAM_START + 002h
R2              		EQU	RAM_START + 004h
R3              		EQU	RAM_START + 006h
R4              		EQU	RAM_START + 008h
R5              		EQU	RAM_START + 00Ah
R6              		EQU	RAM_START + 00Ch
R7              		EQU	RAM_START + 00Eh
R8              		EQU	RAM_START + 010h
FLAGS           		EQU	RAM_START + 012h
GOP             		EQU	RAM_START + 013h
RM1             		EQU	RAM_START + 014h
RM2             		EQU	RAM_START + 015h
RR1             		EQU	RAM_START + 016h
RR2             		EQU	RAM_START + 017h
_T               		EQU	RAM_START + 018h
T1              		EQU	RAM_START + 01Ah
T2              		EQU	RAM_START + 01Ch
_X               		EQU	RAM_START + 01Eh
_DIV1            		EQU	RAM_START + 020h
_HORA            		EQU	RAM_START + 021h
_MINUTO          		EQU	RAM_START + 022h
_SEG             		EQU	RAM_START + 023h
_PORTL           		EQU	 PORTB
_PORTH           		EQU	 PORTC
_TRISL           		EQU	 TRISB
_TRISH           		EQU	 TRISC
#define _inicio          	_PORTB??0
#define _inc             	_PORTB??1
#define _dex             	_PORTB??2
#define _FOCO            	_PORTD??0
#define _BUZZER          	_PORTD??1
#define _PORTB??0        	 PORTB, 000h
#define _PORTB??1        	 PORTB, 001h
#define _PORTB??2        	 PORTB, 002h
#define _PORTD??0        	 PORTD, 000h
#define _PORTD??1        	 PORTD, 001h
	INCLUDE	"TERMAA~1.MAC"
	INCLUDE	"C:\PBP\PBPPIC14.LIB"

	MOVE?CW	01Eh, _X
	MOVE?CW	01Eh, _T

	LABEL?L	_ciclo	
	LCDOUT?C	0FEh
	LCDOUT?C	002h
	LCDOUT?C	054h
	LCDOUT?C	049h
	LCDOUT?C	045h
	LCDOUT?C	04Dh
	LCDOUT?C	050h
	LCDOUT?C	04Fh
	LCDOUT?C	03Ah
	LCDOUTCOUNT?C	000h
	LCDOUTNUM?W	_T
	LCDOUTDEC?	
	LCDOUT?C	06Dh
	LCDOUT?C	069h
	LCDOUT?C	06Eh
	GOSUB?L	_TECLAS
	GOTO?L	_ciclo

	LABEL?L	_TECLAS	
	CMPNE?TCL	_inicio, 001h, L00001
	GOTO?L	_init
	LABEL?L	L00001	
	CMPNE?TCL	_inc, 001h, L00003
	GOSUB?L	_INCREMENTO
	LABEL?L	L00003	
	CMPNE?TCL	_dex, 001h, L00005
	GOSUB?L	_DECREMENTO
	LABEL?L	L00005	
	RETURN?	

	LABEL?L	_INCREMENTO	
	ADD?WCW	_T, 00Ah, _T
	CMPNE?WCL	_T, 0BEh, L00007
	MOVE?CW	000h, _T
	LABEL?L	L00007	
	PAUSE?C	001F4h
	GOSUB?L	_ACTUAL
	RETURN?	

	LABEL?L	_DECREMENTO	
	SUB?WCW	_T, 00Ah, _T
	CMPNE?WCL	_T, 0FFF6h, L00009
	MOVE?CW	0B4h, _T
	LABEL?L	L00009	
	PAUSE?C	001F4h
	GOSUB?L	_ACTUAL
	RETURN?	

	LABEL?L	_ACTUAL	
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	RETURN?	

	LABEL?L	_init	
	MOVE?WW	_T, _X
	MUL?WCW	_T, 03Ch, _T
	MOVE?CB	000h, _HORA
	MOVE?CB	000h, _MINUTO
	MOVE?CB	000h, _SEG
	CMPGE?WCL	_T, 03Ch, L00011
	MOVE?WB	_T, _SEG
	GOTO?L	L00012
	LABEL?L	L00011	
	CMPLT?WCB	_T, 00E10h, T1
	CMPGE?WCB	_T, 03Ch, T2
	LAND?BBW	T1, T2, T2
	CMPF?WL	T2, L00013
	DIV?WCB	_T, 03Ch, _MINUTO
	MOD?WCB	_T, 03Ch, _SEG
	GOTO?L	L00014
	LABEL?L	L00013	
	MOD?WCB	_T, 03Ch, _SEG
	DIV?WCB	_T, 03Ch, _DIV1
	DIV?BCB	_DIV1, 03Ch, _HORA
	MOD?BCB	_DIV1, 03Ch, _MINUTO
	LABEL?L	L00014	
	LABEL?L	L00012	
	GOTO?L	_INIT2

	LABEL?L	_INIT2	
	HIGH?T	_FOCO
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	050h
	LCDOUT?C	052h
	LCDOUT?C	04Fh
	LCDOUT?C	047h
	LCDOUT?C	052h
	LCDOUT?C	041h
	LCDOUT?C	04Dh
	LCDOUT?C	041h
	LCDOUT?C	044h
	LCDOUT?C	04Fh
	LCDOUT?C	03Ah
	LCDOUTCOUNT?C	000h
	LCDOUTNUM?W	_X
	LCDOUTDEC?	
	LCDOUT?C	06Dh
	LCDOUT?C	069h
	LCDOUT?C	06Eh
	LCDOUT?C	0FEh
	LCDOUT?C	0C1h
	LCDOUT?C	051h
	LCDOUT?C	055h
	LCDOUT?C	045h
	LCDOUT?C	044h
	LCDOUT?C	041h
	LCDOUT?C	03Ah
	LCDOUT?C	020h
	LCDOUTCOUNT?C	000h
	LCDOUTNUM?B	_HORA
	LCDOUTDEC?	
	LCDOUT?C	03Ah
	LCDOUTCOUNT?C	000h
	LCDOUTNUM?B	_MINUTO
	LCDOUTDEC?	
	LCDOUT?C	03Ah
	LCDOUTCOUNT?C	000h
	LCDOUTNUM?B	_SEG
	LCDOUTDEC?	
	SUB?BCB	_SEG, 001h, _SEG
	CMPNE?BCL	_SEG, 0FFh, L00015
	MOVE?CB	03Bh, _SEG
	CMPNE?BCL	_MINUTO, 0FFh, L00017
	SUB?BCB	_HORA, 001h, _HORA
	MOVE?CB	03Bh, _MINUTO
	LABEL?L	L00017	
	CMPLT?BCL	_MINUTO, 000h, L00019
	SUB?BCB	_MINUTO, 001h, _MINUTO
	LABEL?L	L00019	
	LABEL?L	L00015	
	CMPEQ?BCB	_MINUTO, 0FFh, T1
	CMPNE?BCB	_SEG, 0FFh, T2
	LAND?BBW	T1, T2, T2
	CMPF?WL	T2, L00021
	MOVE?CB	03Bh, _MINUTO
	SUB?BCB	_HORA, 001h, _HORA
	LABEL?L	L00021	
	CMPNE?WCL	_T, 000h, L00023
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	0FEh
	LCDOUT?C	0C1h
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	050h
	LCDOUT?C	052h
	LCDOUT?C	04Fh
	LCDOUT?C	043h
	LCDOUT?C	045h
	LCDOUT?C	053h
	LCDOUT?C	04Fh
	LCDOUT?C	0FEh
	LCDOUT?C	0C1h
	LCDOUT?C	046h
	LCDOUT?C	049h
	LCDOUT?C	04Eh
	LCDOUT?C	041h
	LCDOUT?C	04Ch
	LCDOUT?C	049h
	LCDOUT?C	05Ah
	LCDOUT?C	041h
	LCDOUT?C	044h
	LCDOUT?C	04Fh
	HIGH?T	_BUZZER
	PAUSE?C	003E8h
	LOW?T	_BUZZER
	LOW?T	_FOCO
	PAUSE?C	003E8h
	HIGH?T	_FOCO
	PAUSE?C	003E8h
	LOW?T	_FOCO
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	GOTO?L	_ciclo
	LABEL?L	L00023	
	SUB?WCW	_T, 001h, _T
	PAUSE?C	003E8h
	GOTO?L	_INIT2
	END?	

	END
